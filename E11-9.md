# 割り込み (interrupt)

割り込み（わりこみ、英: interrupt）とは、コンピュータがその周辺機器などから受
け取る要求の一種である。現在の多くの CPU は、割り込みを処理するための機能を備
えている。 (from ウィキペディア)

→ 文字通り、通常の処理に割り込んで別の処理を行い、**自動的に** もとの処理に戻るための仕組み

<br/>
<div style="text-align: center;">
  <img src="./images/image49.png" width="80%"><br/>
</div>

## 割り込みがないと（１）

長い時間がかかる処理 (重い処理) を中断させることができない

以下のようなプログラムを動かしたとする：

```c++
void loop()
{
    Serial.println("wait for long long time…");
    delay(1000000000000000000000000);
    Serial.println("Hello!!");
}
```
馬鹿げていると思うかも知れないが、Arduino が Hello!! と表示するまで止められない。これが車載やロボット、ピックアンドプレースだったらどうだろうか。
緊急停止などの処理には割り込みが必要でる。

## 割り込みがないと（２）

正確なタイミング処理ができない。
正確に 1 秒を測って、カウントアップしたい。

```c++
void loop()
{
    Serial.println(counter);
    counter = counter + 1;
    delay(1000);
}
```

このようなコードを書いた場合、println 文にもｍ couter の足し算にも、ほんの少しですが処理時間が必要です。そのため、この処理方法だと deley が正確だったとしても、処理時間が積もり積もって少しずつタイミングが遅くなっていきます。

このようなときに割り込みを使うと、マイコンが内蔵しているタイマーを使った正確な１秒間隔での処理が可能になります。